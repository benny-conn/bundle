syntax = "proto3";

option go_package = "github.com/bennycio/bundle/api";

package api;


// USERS ------------------------------------------------------------------ ||

service UsersService {
    rpc Get (GetUserRequest) returns (User){}
    rpc Insert (User) returns (Empty) {}
    rpc Update (UpdateUserRequest) returns (Empty) {}
}


message GetUserRequest {
    string username = 1;
    string email = 2;
}

message UpdateUserRequest {
    string username = 1;
    User updatedUser = 2;
}

message User {
    string id = 1;
    string username = 2;
    string email = 3;
    string password = 4;
    repeated string scopes = 5;
    repeated string plugins = 6;
    string tag = 7;
}

// PLUGINS --------------------------------------------------------------------- ||

service PluginsService {
    rpc Get (GetPluginRequest) returns (Plugin){}
    rpc Insert (Plugin) returns (Empty) {}
    rpc Update (UpdatePluginRequest) returns (Empty) {}
    rpc Paginate (PaginatePluginsRequest) returns (PaginatePluginsResponse) {}
}


message GetPluginRequest {
    string name = 1;
}


message UpdatePluginRequest {
    string name = 1;
    Plugin updatedPlugin = 2;
}

message PaginatePluginsRequest {
    int32 page = 1;
    int32 count = 2;
}

message PaginatePluginsResponse {
    repeated Plugin plugins = 1;
}

message Plugin {
    string id = 1;
    string name = 2;
    string author = 3;
    string version = 4;
    string description = 5;
    string readme = 6;
    int64 lastUpdated = 7;
}



// UTIL ----------------------------------------------------------------- ||


message Empty {
}


